#define GAME_JAR PREFIX_SITE_ROOT("creations/RPGGameCollege/rpg-college-0.1.0.jar")

<!DOCTYPE html>
<html>
  <head>
    <title>RPG Java AWT Game :3</title>
    #include "common_metadata.html"
    #include "include/default_opengraph.html"
    #include "include/popup_to_primary/header.html"
    <link rel="preload" href="https://cjrtnc.leaningtech.com/4.2/loader.js" as="script">
  </head>
  
  <body style="overflow: hidden;">
    <div id="game_output" style="overflow: hidden; width: 100dvw; height: 100dvh;"></div>
    
    <noscript>
      Javascript is REQUIRED! How else the game gonna run -w-<br>
    </noscript>
    
    <div style="display: none;">
      CSS is REQUIRED too<br>
    </div>
    
    #include "include/popup_to_primary/popup.html"
    <details open class="parasitic_popup_simple" style="
        position: fixed;
        left: 0px;
        top: 20px;
        max-width: 400px;
        border: 2px solid white;
      ">
      <summary>
        <span class="parasitic_popup_no_css_message">This is a popup box, but CSS isn't enabled</span>
        <span class="parasitic_popup_arrow parasitic_popup_activate_button" hidden>
          <img width="32" height="32" src=PREFIX_SITE_ROOT("/img/parasitic_popup/right_arrow.png") />
        </span>
        <span class="parasitic_popup_arrow parasitic_popup_deactivate_button" hidden>
          <img width="32" height="32" src=PREFIX_SITE_ROOT("/img/parasitic_popup/left_arrow.png") />
        </span>
      </summary>
      
      You can click <a href=GAME_JAR>here</a> to download the game jar (It requires no dependency)
    </details>
    
    <!-- The game -->
    <script defer>
      async function main() {
        // Prevents default inputs
        let output = document.getElementById("game_output");
        output.addEventListener("click", e => e.preventDefault());
        output.addEventListener("keydown", e => e.preventDefault());
        output.addEventListener("keyup", e => e.preventDefault());
        output.addEventListener("mousedown", e => e.preventDefault());
        output.addEventListener("mouseup", e => e.preventDefault());
        output.addEventListener("mousemove", e => e.preventDefault());
        
        let scale = 0.4;
        const urlParams = new URLSearchParams(window.location.search);
        let scaleArg = urlParams.get("scale");
        if (scaleArg != null) {
          let maybeScale = Number.parseFloat(scaleArg);
          if (Number.isNaN(maybeScale)) {
            alert("Scaling given in URL parameter is not valid number '" + scaleArg + "'. Game will continue at default scaling");
          } else if (!Number.isFinite(maybeScale)) {
            alert("Scaling given in URL parameter is not valid number '" + scaleArg + "'. Game will continue at default scaling");
          }
          
          scale = maybeScale;
        }
        
        await cheerpjInit({
          version: 17,
          clipboardMode: "java",
          preloadResourcs: JSON.parse('{"/lt/17/lib/modules":[0,131072,1179648,2097152,2228224,4718592,4849664,5898240,6029312,6291456,6684672,7208960,7864320,8388608,9437184,9699328,9961472,10092544,19791872,19922944,20054016,20447232,21102592,22282240,22544384,22675456,22937600,23199744,25165824,25559040,26083328,27394048,27656192,27787264,37486592,37617664,38010880,38141952],"/lt/etc/users":[0,131072],"/lt/etc/localtime":[],"/lt/17/jre/lib/cheerpj-handlers.jar":[0,131072],"/lt/17/jre/lib/cheerpj-awt.jar":[0,131072],"/lt/17/jre/lib/cheerpj-jsobject.jar":[0,131072],"/lt/17/conf/security/java.security":[0,131072],"/lt/17/conf/accessibility.properties":[],"/lt/17/lib/fonts/badfonts.txt":[],"/lt/17/lib/fonts":[],"/lt/17/lib/fonts/fallback":[],"/lt/fc/fonts/fonts.conf":[0,131072],"/lt/fc/ttf":[],"/lt/fc/cache/e21edda6a7db77f35ca341e0c3cb2a22-le32d8.cache-7":[0,131072]}'),
          overrideShortcuts: function (e) {
            return true;
          }
        });
        cheerpjCreateDisplay(-1, -1, output);
        await cheerpjRunJar("/app/" GAME_JAR, "fullscreen", "double_buffering", "scaling=" + scale);
      }
    </script>
    <script onload="main()" async defer src="https://cjrtnc.leaningtech.com/4.2/loader.js"></script>
  </body>
</html>